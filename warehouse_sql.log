[2025-09-19 13:35:35.058] PURPOSE: Rilevamento colonne Celle\n[2025-09-19 13:35:35.058] SQL:\n[2025-09-19 13:35:35.058]   SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');\n[2025-09-19 13:35:35.058] PARAMS: {}\n[2025-09-19 13:35:35.058] ELAPSED_MS: 0\n--------------------------------------------------------------------------------\n[2025-09-19 13:35:35.145] PURPOSE: Lista Aree\n[2025-09-19 13:35:35.145] INFO: START\n[2025-09-19 13:35:35.145] SQL:\n[2025-09-19 13:35:35.145]   SELECT\n[2025-09-19 13:35:35.145]       a.ID           AS AreaID,\n[2025-09-19 13:35:35.145]       a.Descrizione  AS AreaNome,\n[2025-09-19 13:35:35.145]       a.IDMagazzino  AS MagID,\n[2025-09-19 13:35:35.145]       m.Codice       AS Magazzino\n[2025-09-19 13:35:35.145]   FROM dbo.Aree a\n[2025-09-19 13:35:35.145]   JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:35:35.145]   WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'\n[2025-09-19 13:35:35.145]   ORDER BY m.Codice, a.Descrizione;\n[2025-09-19 13:35:35.145] PARAMS: {}\n--------------------------------------------------------------------------------\n[2025-09-19 13:35:35.161] PURPOSE: Lista Aree\n[2025-09-19 13:35:35.161] INFO: END\n[2025-09-19 13:35:35.161] SQL:\n[2025-09-19 13:35:35.161]   SELECT\n[2025-09-19 13:35:35.161]       a.ID           AS AreaID,\n[2025-09-19 13:35:35.161]       a.Descrizione  AS AreaNome,\n[2025-09-19 13:35:35.161]       a.IDMagazzino  AS MagID,\n[2025-09-19 13:35:35.161]       m.Codice       AS Magazzino\n[2025-09-19 13:35:35.161]   FROM dbo.Aree a\n[2025-09-19 13:35:35.161]   JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:35:35.161]   WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'\n[2025-09-19 13:35:35.161]   ORDER BY m.Codice, a.Descrizione;\n[2025-09-19 13:35:35.161] PARAMS: {}\n[2025-09-19 13:35:35.161] ELAPSED_MS: 14\n--------------------------------------------------------------------------------\n[2025-09-19 13:35:35.187] PURPOSE: Statistiche Scaffali per Area\n[2025-09-19 13:35:35.187] INFO: START\n[2025-09-19 13:35:35.187] SQL:\n[2025-09-19 13:35:35.187]   WITH CELLE AS (\n[2025-09-19 13:35:35.187]               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale\n[2025-09-19 13:35:35.187]               FROM dbo.Celle c\n[2025-09-19 13:35:35.187]               WHERE c.IDArea = :area_id\n[2025-09-19 13:35:35.187]           ),\n[2025-09-19 13:35:35.187]           OCC AS (\n[2025-09-19 13:35:35.187]               SELECT c.Scaffale, COUNT(*) AS CelleTotali\n[2025-09-19 13:35:35.187]               FROM CELLE c\n[2025-09-19 13:35:35.187]               GROUP BY c.Scaffale\n[2025-09-19 13:35:35.187]           ),\n[2025-09-19 13:35:35.187]           OCC2 AS (\n[2025-09-19 13:35:35.187]               SELECT c.Scaffale,\n[2025-09-19 13:35:35.187]                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,\n[2025-09-19 13:35:35.187]                      COUNT(mp.ID)               AS NPalet\n[2025-09-19 13:35:35.187]               FROM CELLE c\n[2025-09-19 13:35:35.187]               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella\n[2025-09-19 13:35:35.187]               GROUP BY c.Scaffale\n[2025-09-19 13:35:35.187]           )\n[2025-09-19 13:35:35.187]           SELECT\n[2025-09-19 13:35:35.187]               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,\n[2025-09-19 13:35:35.187]               o.Scaffale                              AS Scaffale,\n[2025-09-19 13:35:35.187]               a.IDMagazzino                            AS MagID,\n[2025-09-19 13:35:35.187]               m.Codice                                 AS Magazzino,\n[2025-09-19 13:35:35.187]               ISNULL(o2.NPalet,0)                      AS NPalet,\n[2025-09-19 13:35:35.187]               o.CelleTotali                            AS CelleTotali,\n[2025-09-19 13:35:35.187]               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate\n[2025-09-19 13:35:35.187]           FROM OCC o\n[2025-09-19 13:35:35.187]           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale\n[2025-09-19 13:35:35.187]           JOIN dbo.Aree a ON a.ID = :area_id\n[2025-09-19 13:35:35.187]           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:35:35.187]           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''\n[2025-09-19 13:35:35.187]           ORDER BY o.Scaffale;\n[2025-09-19 13:35:35.187] PARAMS: {'area_id': 1}\n--------------------------------------------------------------------------------\n[2025-09-19 13:35:35.319] PURPOSE: Statistiche Scaffali per Area\n[2025-09-19 13:35:35.319] INFO: END\n[2025-09-19 13:35:35.319] SQL:\n[2025-09-19 13:35:35.319]   WITH CELLE AS (\n[2025-09-19 13:35:35.319]               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale\n[2025-09-19 13:35:35.319]               FROM dbo.Celle c\n[2025-09-19 13:35:35.319]               WHERE c.IDArea = :area_id\n[2025-09-19 13:35:35.319]           ),\n[2025-09-19 13:35:35.319]           OCC AS (\n[2025-09-19 13:35:35.319]               SELECT c.Scaffale, COUNT(*) AS CelleTotali\n[2025-09-19 13:35:35.319]               FROM CELLE c\n[2025-09-19 13:35:35.319]               GROUP BY c.Scaffale\n[2025-09-19 13:35:35.319]           ),\n[2025-09-19 13:35:35.319]           OCC2 AS (\n[2025-09-19 13:35:35.319]               SELECT c.Scaffale,\n[2025-09-19 13:35:35.319]                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,\n[2025-09-19 13:35:35.319]                      COUNT(mp.ID)               AS NPalet\n[2025-09-19 13:35:35.319]               FROM CELLE c\n[2025-09-19 13:35:35.319]               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella\n[2025-09-19 13:35:35.319]               GROUP BY c.Scaffale\n[2025-09-19 13:35:35.319]           )\n[2025-09-19 13:35:35.319]           SELECT\n[2025-09-19 13:35:35.319]               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,\n[2025-09-19 13:35:35.319]               o.Scaffale                              AS Scaffale,\n[2025-09-19 13:35:35.319]               a.IDMagazzino                            AS MagID,\n[2025-09-19 13:35:35.319]               m.Codice                                 AS Magazzino,\n[2025-09-19 13:35:35.319]               ISNULL(o2.NPalet,0)                      AS NPalet,\n[2025-09-19 13:35:35.319]               o.CelleTotali                            AS CelleTotali,\n[2025-09-19 13:35:35.319]               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate\n[2025-09-19 13:35:35.319]           FROM OCC o\n[2025-09-19 13:35:35.319]           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale\n[2025-09-19 13:35:35.319]           JOIN dbo.Aree a ON a.ID = :area_id\n[2025-09-19 13:35:35.319]           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:35:35.319]           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''\n[2025-09-19 13:35:35.319]           ORDER BY o.Scaffale;\n[2025-09-19 13:35:35.319] PARAMS: {'area_id': 1}\n[2025-09-19 13:35:35.319] ELAPSED_MS: 131\n--------------------------------------------------------------------------------\n[2025-09-19 13:39:31.959] PURPOSE: Statistiche Scaffali per Area\n[2025-09-19 13:39:31.959] INFO: START\n[2025-09-19 13:39:31.959] SQL:\n[2025-09-19 13:39:31.959]   WITH CELLE AS (\n[2025-09-19 13:39:31.959]               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale\n[2025-09-19 13:39:31.959]               FROM dbo.Celle c\n[2025-09-19 13:39:31.959]               WHERE c.IDArea = :area_id\n[2025-09-19 13:39:31.959]           ),\n[2025-09-19 13:39:31.959]           OCC AS (\n[2025-09-19 13:39:31.959]               SELECT c.Scaffale, COUNT(*) AS CelleTotali\n[2025-09-19 13:39:31.959]               FROM CELLE c\n[2025-09-19 13:39:31.959]               GROUP BY c.Scaffale\n[2025-09-19 13:39:31.959]           ),\n[2025-09-19 13:39:31.959]           OCC2 AS (\n[2025-09-19 13:39:31.959]               SELECT c.Scaffale,\n[2025-09-19 13:39:31.959]                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,\n[2025-09-19 13:39:31.959]                      COUNT(mp.ID)               AS NPalet\n[2025-09-19 13:39:31.959]               FROM CELLE c\n[2025-09-19 13:39:31.959]               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella\n[2025-09-19 13:39:31.959]               GROUP BY c.Scaffale\n[2025-09-19 13:39:31.959]           )\n[2025-09-19 13:39:31.959]           SELECT\n[2025-09-19 13:39:31.959]               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,\n[2025-09-19 13:39:31.959]               o.Scaffale                              AS Scaffale,\n[2025-09-19 13:39:31.959]               a.IDMagazzino                            AS MagID,\n[2025-09-19 13:39:31.959]               m.Codice                                 AS Magazzino,\n[2025-09-19 13:39:31.959]               ISNULL(o2.NPalet,0)                      AS NPalet,\n[2025-09-19 13:39:31.959]               o.CelleTotali                            AS CelleTotali,\n[2025-09-19 13:39:31.959]               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate\n[2025-09-19 13:39:31.959]           FROM OCC o\n[2025-09-19 13:39:31.959]           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale\n[2025-09-19 13:39:31.959]           JOIN dbo.Aree a ON a.ID = :area_id\n[2025-09-19 13:39:31.959]           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:39:31.959]           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''\n[2025-09-19 13:39:31.959]           ORDER BY o.Scaffale;\n[2025-09-19 13:39:31.959] PARAMS: {'area_id': 4}\n--------------------------------------------------------------------------------\n[2025-09-19 13:39:32.045] PURPOSE: Statistiche Scaffali per Area\n[2025-09-19 13:39:32.045] INFO: END\n[2025-09-19 13:39:32.045] SQL:\n[2025-09-19 13:39:32.045]   WITH CELLE AS (\n[2025-09-19 13:39:32.045]               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale\n[2025-09-19 13:39:32.045]               FROM dbo.Celle c\n[2025-09-19 13:39:32.045]               WHERE c.IDArea = :area_id\n[2025-09-19 13:39:32.045]           ),\n[2025-09-19 13:39:32.045]           OCC AS (\n[2025-09-19 13:39:32.045]               SELECT c.Scaffale, COUNT(*) AS CelleTotali\n[2025-09-19 13:39:32.045]               FROM CELLE c\n[2025-09-19 13:39:32.045]               GROUP BY c.Scaffale\n[2025-09-19 13:39:32.045]           ),\n[2025-09-19 13:39:32.045]           OCC2 AS (\n[2025-09-19 13:39:32.045]               SELECT c.Scaffale,\n[2025-09-19 13:39:32.045]                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,\n[2025-09-19 13:39:32.045]                      COUNT(mp.ID)               AS NPalet\n[2025-09-19 13:39:32.045]               FROM CELLE c\n[2025-09-19 13:39:32.045]               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella\n[2025-09-19 13:39:32.045]               GROUP BY c.Scaffale\n[2025-09-19 13:39:32.045]           )\n[2025-09-19 13:39:32.045]           SELECT\n[2025-09-19 13:39:32.045]               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,\n[2025-09-19 13:39:32.045]               o.Scaffale                              AS Scaffale,\n[2025-09-19 13:39:32.045]               a.IDMagazzino                            AS MagID,\n[2025-09-19 13:39:32.045]               m.Codice                                 AS Magazzino,\n[2025-09-19 13:39:32.045]               ISNULL(o2.NPalet,0)                      AS NPalet,\n[2025-09-19 13:39:32.045]               o.CelleTotali                            AS CelleTotali,\n[2025-09-19 13:39:32.045]               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate\n[2025-09-19 13:39:32.045]           FROM OCC o\n[2025-09-19 13:39:32.045]           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale\n[2025-09-19 13:39:32.045]           JOIN dbo.Aree a ON a.ID = :area_id\n[2025-09-19 13:39:32.045]           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino\n[2025-09-19 13:39:32.045]           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''\n[2025-09-19 13:39:32.045]           ORDER BY o.Scaffale;\n[2025-09-19 13:39:32.045] PARAMS: {'area_id': 4}\n[2025-09-19 13:39:32.045] ELAPSED_MS: 85\n--------------------------------------------------------------------------------\n[2025-09-19 13:39:41.285] PURPOSE: SIMULAZIONE Azzeramento Area (conteggio)\n[2025-09-19 13:39:41.285] INFO: START\n[2025-09-19 13:39:41.285] SQL:\n[2025-09-19 13:39:41.285]   SELECT COUNT(*) AS WouldDelete\n[2025-09-19 13:39:41.285]   FROM dbo.MagazziniPallet mp\n[2025-09-19 13:39:41.285]   JOIN dbo.Celle c ON c.ID = mp.IDCella\n[2025-09-19 13:39:41.285]   WHERE c.IDArea = :area_id;\n[2025-09-19 13:39:41.285] PARAMS: {'area_id': 4}\n--------------------------------------------------------------------------------\n[2025-09-19 13:39:41.353] PURPOSE: SIMULAZIONE Azzeramento Area (conteggio)\n[2025-09-19 13:39:41.353] INFO: END\n[2025-09-19 13:39:41.353] SQL:\n[2025-09-19 13:39:41.353]   SELECT COUNT(*) AS WouldDelete\n[2025-09-19 13:39:41.353]   FROM dbo.MagazziniPallet mp\n[2025-09-19 13:39:41.353]   JOIN dbo.Celle c ON c.ID = mp.IDCella\n[2025-09-19 13:39:41.353]   WHERE c.IDArea = :area_id;\n[2025-09-19 13:39:41.353] PARAMS: {'area_id': 4}\n[2025-09-19 13:39:41.353] ELAPSED_MS: 67\n--------------------------------------------------------------------------------\n+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:18.622                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL:                                                                                                       |
|   SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');                            |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:18.663                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL:                                                                                                       |
|   SELECT                                                                                                   |
|       a.ID           AS AreaID,                                                                            |
|       a.Descrizione  AS AreaNome,                                                                          |
|       a.IDMagazzino  AS MagID,                                                                             |
|       m.Codice       AS Magazzino                                                                          |
|   FROM dbo.Aree a                                                                                          |
|   JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino                                                             |
|   WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'                                                  |
|   ORDER BY m.Codice, a.Descrizione;                                                                        |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:18.668                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 3 ms                                                                                           |
|                                                                                                            |
| SQL:                                                                                                       |
|   SELECT                                                                                                   |
|       a.ID           AS AreaID,                                                                            |
|       a.Descrizione  AS AreaNome,                                                                          |
|       a.IDMagazzino  AS MagID,                                                                             |
|       m.Codice       AS Magazzino                                                                          |
|   FROM dbo.Aree a                                                                                          |
|   JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino                                                             |
|   WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'                                                  |
|   ORDER BY m.Codice, a.Descrizione;                                                                        |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:18.675                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL:                                                                                                       |
|           WITH CELLE AS (                                                                                  |
|               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale                 |
|               FROM dbo.Celle c                                                                             |
|               WHERE c.IDArea = :area_id                                                                    |
|           ),                                                                                               |
|           OCC AS (                                                                                         |
|               SELECT c.Scaffale, COUNT(*) AS CelleTotali                                                   |
|               FROM CELLE c                                                                                 |
|               GROUP BY c.Scaffale                                                                          |
|           ),                                                                                               |
|           OCC2 AS (                                                                                        |
|               SELECT c.Scaffale,                                                                           |
|                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,                                          |
|                      COUNT(mp.ID)               AS NPalet                                                  |
|               FROM CELLE c                                                                                 |
|               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella                                   |
|               GROUP BY c.Scaffale                                                                          |
|           )                                                                                                |
|           SELECT                                                                                           |
|               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,                                               |
|               o.Scaffale                              AS Scaffale,                                         |
|               a.IDMagazzino                            AS MagID,                                           |
|               m.Codice                                 AS Magazzino,                                       |
|               ISNULL(o2.NPalet,0)                      AS NPalet,                                          |
|               o.CelleTotali                            AS CelleTotali,                                     |
|               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate                                    |
|           FROM OCC o                                                                                       |
|           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale                                                    |
|           JOIN dbo.Aree a ON a.ID = :area_id                                                               |
|           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino                                                     |
|           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''                                  |
|           ORDER BY o.Scaffale;                                                                             |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:18.801                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 125 ms                                                                                         |
|                                                                                                            |
| SQL:                                                                                                       |
|           WITH CELLE AS (                                                                                  |
|               SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale                 |
|               FROM dbo.Celle c                                                                             |
|               WHERE c.IDArea = :area_id                                                                    |
|           ),                                                                                               |
|           OCC AS (                                                                                         |
|               SELECT c.Scaffale, COUNT(*) AS CelleTotali                                                   |
|               FROM CELLE c                                                                                 |
|               GROUP BY c.Scaffale                                                                          |
|           ),                                                                                               |
|           OCC2 AS (                                                                                        |
|               SELECT c.Scaffale,                                                                           |
|                      COUNT(DISTINCT mp.IDCella) AS CelleOccupate,                                          |
|                      COUNT(mp.ID)               AS NPalet                                                  |
|               FROM CELLE c                                                                                 |
|               LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella                                   |
|               GROUP BY c.Scaffale                                                                          |
|           )                                                                                                |
|           SELECT                                                                                           |
|               ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,                                               |
|               o.Scaffale                              AS Scaffale,                                         |
|               a.IDMagazzino                            AS MagID,                                           |
|               m.Codice                                 AS Magazzino,                                       |
|               ISNULL(o2.NPalet,0)                      AS NPalet,                                          |
|               o.CelleTotali                            AS CelleTotali,                                     |
|               ISNULL(o2.CelleOccupate,0)               AS CelleOccupate                                    |
|           FROM OCC o                                                                                       |
|           LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale                                                    |
|           JOIN dbo.Aree a ON a.ID = :area_id                                                               |
|           JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino                                                     |
|           WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''                                  |
|           ORDER BY o.Scaffale;                                                                             |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:38.222                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Area (conteggio)                                                       |
|                                                                                                            |
| SQL:                                                                                                       |
|   SELECT COUNT(*) AS WouldDelete                                                                           |
|   FROM dbo.MagazziniPallet mp                                                                              |
|   JOIN dbo.Celle c ON c.ID = mp.IDCella                                                                    |
|   WHERE c.IDArea = :area_id;                                                                               |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 14:05:38.286                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Area (conteggio)                                                       |
| ELAPSED   : 63 ms                                                                                          |
|                                                                                                            |
| SQL:                                                                                                       |
|   SELECT COUNT(*) AS WouldDelete                                                                           |
|   FROM dbo.MagazziniPallet mp                                                                              |
|   JOIN dbo.Celle c ON c.ID = mp.IDCella                                                                    |
|   WHERE c.IDArea = :area_id;                                                                               |
|                                                                                                            |
| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-19 15:57:33.565                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:16:04.836                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:16:13.102                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:16:13.103                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:14.522                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:18.641                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:18.642                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:47.270                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:57.020                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:20:57.021                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:23:52.920                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:23:54.812                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:23:54.813                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:38:09.469                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:38:11.042                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-29 19:38:11.043                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:33:49.156                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:34:01.696                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:34:16.430                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:34:16.431                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:34:17.646                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-09-30 11:34:17.647                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
WHERE a.DelDataOra IS NULL OR a.DelDataOra = '19000101'
ORDER BY m.Codice, a.Descrizione;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:38:38.587                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:38:38.624                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:38:38.630                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 5 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:38:38.718                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:38:38.804                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 85 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:04.697                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 4                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:04.749                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 51 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 4                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:08.033                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 11                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:08.686                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 652 ms                                                                                         |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 11                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:12.809                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 11                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:12.873                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 63 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 11                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:16.609                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 13                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:16.664                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 54 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 13                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:19.066                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 14                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:19.112                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 45 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 14                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:21.897                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 12                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:21.939                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 40 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 12                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:37.725                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 13                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:37.772                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 46 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 13                                                                                          |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:41.282                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:39:41.345                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 63 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:44:05.736                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:44:05.806                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:44:05.809                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 3 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:44:05.812                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:44:05.889                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 77 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:21.269                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:21.359                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:21.363                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 3 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:21.448                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:21.526                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 77 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:37.304                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Scaffale (conteggio)                                                   |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT COUNT(*) AS WouldDelete
FROM dbo.MagazziniPallet mp
JOIN dbo.Celle c ON c.ID = mp.IDCella
WHERE c.IDArea = :area_id AND CAST([Corsia] AS NVARCHAR(50)) = :scaffale;

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1,                                                                                          |
|     "scaffale": " 1A"                                                                                      |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:37.355                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Scaffale (conteggio)                                                   |
| ELAPSED   : 50 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT COUNT(*) AS WouldDelete
FROM dbo.MagazziniPallet mp
JOIN dbo.Celle c ON c.ID = mp.IDCella
WHERE c.IDArea = :area_id AND CAST([Corsia] AS NVARCHAR(50)) = :scaffale;

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1,                                                                                          |
|     "scaffale": " 1A"                                                                                      |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:45.607                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Scaffale (conteggio)                                                   |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT COUNT(*) AS WouldDelete
FROM dbo.MagazziniPallet mp
JOIN dbo.Celle c ON c.ID = mp.IDCella
WHERE c.IDArea = :area_id AND CAST([Corsia] AS NVARCHAR(50)) = :scaffale;

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1,                                                                                          |
|     "scaffale": " 1A"                                                                                      |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:46:45.658                                                                        |
| PURPOSE   : SIMULAZIONE Azzeramento Scaffale (conteggio)                                                   |
| ELAPSED   : 51 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT COUNT(*) AS WouldDelete
FROM dbo.MagazziniPallet mp
JOIN dbo.Celle c ON c.ID = mp.IDCella
WHERE c.IDArea = :area_id AND CAST([Corsia] AS NVARCHAR(50)) = :scaffale;

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1,                                                                                          |
|     "scaffale": " 1A"                                                                                      |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:56:37.640                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:56:37.706                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:56:37.711                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 3 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:56:37.800                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:56:37.880                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 79 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:09.968                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:10.044                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:10.051                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 6 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:10.138                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:10.221                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 82 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:40.974                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:41.012                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:41.017                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 4 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:41.022                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:57:41.089                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 66 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:58:05.716                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:58:05.807                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 12:58:05.812                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 4 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 17:11:06.431                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 17:11:06.462                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 17:11:06.468                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 5 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 17:11:06.471                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-01 17:11:06.555                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 83 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:07.101                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:07.151                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:07.157                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 5 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:07.159                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:07.239                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 79 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:17.431                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:19.489                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:19.495                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 5 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:19.500                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT TOP 0 1 AS ID, '' AS Scaffale, 0 AS MagID, '' AS Magazzino, 0 AS NPalet, 0 AS CelleTotali, 0 AS CelleOccupate

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:19.503                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 2 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT TOP 0 1 AS ID, '' AS Scaffale, 0 AS MagID, '' AS Magazzino, 0 AS NPalet, 0 AS CelleTotali, 0 AS CelleOccupate

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:23.854                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:23.861                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:23.863                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 1 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:23.869                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-03 20:49:23.930                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 60 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:48:50.855                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:48:50.925                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:48:50.935                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 9 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:48:50.952                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:48:51.050                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 98 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:34.467                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:37.275                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:37.284                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 8 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:45.245                                                                        |
| PURPOSE   : Rilevamento colonne Celle                                                                      |
| ELAPSED   : 0 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT LOWER(name) FROM sys.columns WHERE object_id = OBJECT_ID('dbo.Celle');

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:45.324                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:45.327                                                                        |
| PURPOSE   : Lista Aree                                                                                     |
| ELAPSED   : 2 ms                                                                                           |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
SELECT a.ID AS AreaID, a.Descrizione AS AreaNome, a.IDMagazzino AS MagID, m.Codice AS Magazzino
FROM dbo.Aree a
JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino 
WHERE len(trim(a.Descrizione)) = 2;

| PARAMS:                                                                                                    |
|   {}                                                                                                       |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:45.335                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   START                                                                                                    |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
+------------------------------------------------------------------------------------------------------------+
| TIMESTAMP : 2025-10-04 11:49:45.412                                                                        |
| PURPOSE   : Statistiche Scaffali per Area                                                                  |
| ELAPSED   : 76 ms                                                                                          |
|                                                                                                            |
| SQL (copy/paste below):                                                                                    |
|                                                                                                            |
        WITH CELLE AS (
            SELECT c.ID AS IDCella, c.IDArea, CAST([Corsia] AS NVARCHAR(50)) AS Scaffale
            FROM dbo.Celle c
            WHERE c.IDArea = :area_id
        ),
        OCC AS (
            SELECT c.Scaffale, COUNT(*) AS CelleTotali
            FROM CELLE c
            GROUP BY c.Scaffale
        ),
        OCC2 AS (
            SELECT c.Scaffale,
                   COUNT(DISTINCT mp.IDCella) AS CelleOccupate,
                   COUNT(mp.ID)               AS NPalet
            FROM CELLE c
            LEFT JOIN dbo.MagazziniPallet mp ON mp.IDCella = c.IDCella
            GROUP BY c.Scaffale
        )
        SELECT
            ROW_NUMBER() OVER (ORDER BY o.Scaffale) AS ID,
            o.Scaffale                              AS Scaffale,
            a.IDMagazzino                            AS MagID,
            m.Codice                                 AS Magazzino,
            ISNULL(o2.NPalet,0)                      AS NPalet,
            o.CelleTotali                            AS CelleTotali,
            ISNULL(o2.CelleOccupate,0)               AS CelleOccupate
        FROM OCC o
        LEFT JOIN OCC2 o2 ON o2.Scaffale = o.Scaffale
        JOIN dbo.Aree a ON a.ID = :area_id
        JOIN dbo.Magazzini m ON m.ID = a.IDMagazzino
        WHERE o.Scaffale IS NOT NULL AND LTRIM(RTRIM(o.Scaffale)) <> ''
        ORDER BY o.Scaffale;
        

| PARAMS:                                                                                                    |
|   {                                                                                                        |
|     "area_id": 1                                                                                           |
|   }                                                                                                        |
|                                                                                                            |
| COMMENT:                                                                                                   |
|   END                                                                                                      |
|                                                                                                            |
+------------------------------------------------------------------------------------------------------------+
